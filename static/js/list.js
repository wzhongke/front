function appendList(a){if(!a)return!1;for(var i="",l=0;l<a.length;l++){var t=a[l],o="img_"+global.offset+"_"+l,e=updateImgUrl(t.image_url);window[o]='<img src="'+e+'" alt="" width="100%" height="100%">';i+='<div class="item clearfix" data-id="'+t.doc_id+'">  <div class="left">    <a class="title">'+t.title+'</a>    <div class="tag">'+t.tag.join(" ")+'</div>  </div>  <div class="right"> <iframe src="javascript:parent.'+o+';" frameBorder="0" scrolling="no" width="100%" height="100%"></iframe>  </div></div>'}return $(".page-list").append(i),!0}function updateImgUrl(a){if(!a)return a;var i=a.split("?");if(i.length<2)return a;for(var l=i[0],t=i[1].split("&"),o=[],e=0;e<t.length;e++)"tp=webp"!==t[e]&&o.push(t[e]);return l+="?"+o.join("&")}function loadPage(){if(global.loading||!global.hasMore)return!1;global.loading=!0;var a={pn:global.offset,rn:global.limit};$.post("/webapi/doc/mainpage",a,function(a){global.offset+=global.limit,global.loading=!1,(!a.data.doc||a.data.doc.length<global.limit)&&(global.hasMore=!1),appendList(a.data.doc)},"json")}var global={offset:0,limit:10,loading:!1,hasMore:!0};$(function(){$(".page-list").on("click",".item",function(){location.href="/article/"+$(this).data("id")}),loadPage(),window.addEventListener("scroll",function(){$(window).scrollTop()+$(window).height()>=$(document).height()&&loadPage()},!1)});